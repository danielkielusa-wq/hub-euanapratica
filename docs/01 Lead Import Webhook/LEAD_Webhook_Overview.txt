âœ… Sistema de Webhook de Leads Configurado com Sucesso!
Implementei um sistema completo e configurÃ¡vel de webhooks para notificar o n8n sobre novos leads. Aqui estÃ¡ o resumo:

ğŸ¯ O que foi implementado:
1. Sistema de Webhook AutomÃ¡tico
âœ… Trigger PostgreSQL que dispara em toda inserÃ§Ã£o na tabela career_evaluations
âœ… FunÃ§Ã£o notify_new_lead() que envia POST via pg_net para o n8n
âœ… Payload completo com todos os campos do lead + report_link
âœ… Link do relatÃ³rio sempre comeÃ§a com https://hub.euanapratica.com
2. Interface de AdministraÃ§Ã£o
âœ… Nova aba "RelatÃ³rios de Carreira" em Admin â†’ ConfiguraÃ§Ãµes
âœ… ConfiguraÃ§Ã£o da URL do webhook (sem hardcode!)
âœ… ConfiguraÃ§Ã£o da URL base dos relatÃ³rios
âœ… Switch para ativar/desativar webhooks
âœ… Timestamps de Ãºltima atualizaÃ§Ã£o
3. ConfiguraÃ§Ãµes DinÃ¢micas
Todas as configuraÃ§Ãµes ficam no app_configs:

lead_webhook_url - URL do webhook n8n
lead_webhook_enabled - true/false para ativar/desativar
lead_report_base_url - URL base para gerar links
4. DocumentaÃ§Ã£o Completa
ğŸ“„ docs/LEAD_WEBHOOK.md - DocumentaÃ§Ã£o tÃ©cnica detalhada
ğŸ“„ docs/LEAD_WEBHOOK_SETUP.md - Guia de configuraÃ§Ã£o rÃ¡pida
ğŸ“„ test_webhook.sql - Script de teste
ğŸš€ Como usar:
Passo 1: Configurar via Admin
Acesse Admin â†’ ConfiguraÃ§Ãµes
Clique na aba "RelatÃ³rios de Carreira"
Configure:
URL do Webhook: https://n8n.sapunplugged.com/webhook/7df09015-3dc7-45f8-8390-54a7f3180191
URL Base dos RelatÃ³rios: https://hub.euanapratica.com
Webhook Ativo: ON
Clique em "Salvar ConfiguraÃ§Ãµes"
Passo 2: Testar
Execute o test_webhook.sql no Supabase SQL Editor para inserir um lead de teste e verificar se o webhook foi disparado.

Passo 3: Configurar n8n
Configure o workflow do n8n para receber o POST e processar o lead (enviar email, adicionar ao CRM, etc.)

ğŸ“¦ Payload enviado ao n8n:

{
  "id": "uuid",
  "name": "Nome do Lead",
  "email": "lead@email.com",
  "phone": "+5511999999999",
  "report_link": "https://hub.euanapratica.com/report/uuid-token",
  // ... todos os outros campos do lead
}
âœ¨ Funciona automaticamente para:
âœ… Leads importados via planilha CSV
âœ… Leads inseridos manualmente no Supabase
âœ… Leads inseridos via API
âœ… Qualquer INSERT na tabela career_evaluations
ğŸ“š Arquivos criados/modificados:
Migrations:

supabase/migrations/20260209000000_lead_webhook_trigger.sql - Trigger inicial
supabase/migrations/20260209100000_lead_webhook_config.sql - Configs dinÃ¢micas
Admin UI:

src/pages/admin/AdminSettings.tsx - Nova aba "RelatÃ³rios de Carreira"
DocumentaÃ§Ã£o:

docs/LEAD_WEBHOOK.md - DocumentaÃ§Ã£o tÃ©cnica
docs/LEAD_WEBHOOK_SETUP.md - Guia rÃ¡pido
test_webhook.sql - Script de teste